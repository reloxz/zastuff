_G.antiloud = true
_G.songloudnesscheck = false

local antiNoiseLoop = coroutine.wrap(function()
	print("[AntiLoud] Starting loop...")
	while _G.antiloud do
		task.wait(0.2)
		for _, sound in ipairs(game.Workspace:GetDescendants()) do
			if sound:IsA("Sound") and sound.IsPlaying then
				if not sound:IsDescendantOf(game:GetService("ReplicatedStorage")) then
					if sound.PlaybackLoudness > 450 then
						print("[AntiLoud] Detected loud sound:", sound.Name, sound.SoundId)
						sound.Name = "LoudSound"
						print("[AntiLoud] Waiting for sound to be muted...")

						repeat
							task.wait()
						until sound.Volume == 0 or not sound:IsDescendantOf(game)

						_G.songloudnesscheck = false
						print("[AntiLoud] Done waiting, loop continues")
					end
				end
			end
		end
	end
	print("[AntiLoud] Loop ended")
end)

antiNoiseLoop()
