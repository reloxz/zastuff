local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local StarterGui = game:GetService("StarterGui")

local COMMAND_URL = "http://localhost:3000/latest-command" -- Or your remote URL

local function displaySystemMessage(text)
	pcall(function()
		StarterGui:SetCore("ChatMakeSystemMessage", {
			Text = "[Discord] " .. text,
			Color = Color3.fromRGB(100, 255, 100),
			Font = Enum.Font.SourceSansBold,
			FontSize = Enum.FontSize.Size24
		})
	end)
end

local function runCommand(commandData)
	if not commandData or not commandData.text then return end

	local sender = commandData.sender
	local text = commandData.text:lower()

	-- Example: !say Hello there
	if text:sub(1, 4) == "say " then
		local message = text:sub(5)
		displaySystemMessage(`${sender}: ${message}`)
	end

end

while true do
	task.wait(2)

	local success, response = pcall(function()
		return HttpService:GetAsync(COMMAND_URL)
	end)

	if success then
		local data = HttpService:JSONDecode(response)
		if data and data.command then
			runCommand(data.command)
		end
	else
		warn("Failed to fetch Discord command:", response)
	end
end
