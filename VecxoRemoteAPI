local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local COMMAND_URL = "https://7b6c2b03847e.ngrok-free.app/latest-command"--//constantly changing server

local banned = {}

local function runCommand(cmd)
	if not cmd or not cmd.text then return end
	local sender = cmd.sender or "Discord"
	local text = cmd.text:lower()

	print("[COMMAND RECEIVED] From:", sender, "| Command:", text)

	if text:sub(1, 4) == "say " then
		local msg = cmd.text:sub(5)
		print(`[DISCORD] {sender}: {msg}`)
	end

	if text:sub(1, 2) == "m " then
		local msg = cmd.text:sub(3)
		m=Instance.new("Message",game.workspace)
		m.Text = `[Vecxo Remote API]: {sender}: {msg}`
		wait(5)
		m:Destroy()
	end

	if text:sub(1, 5) == "kick " then
		local targetName = text:sub(6):lower()
		for _, plr in pairs(Players:GetPlayers()) do
			if plr.Name:lower():sub(1, #targetName) == targetName then
				plr:Kick(`[Vecxo Remote API] You were kicked from the game remotely by {sender}.`)
				break
			end
		end
	end

	if text:sub(1, 4) == "ban " then
		local targetName = text:sub(5):lower()
		for _, plr in pairs(Players:GetPlayers()) do
			if plr.Name:lower():sub(1, #targetName) == targetName then
				table.insert(banned, plr.Name)
				plr:Kick(`[Vecxo Remote API] You were banned from the game remotely by {sender}.`)
				break
			end
		end
	end

	if text == "shutdown" then
		for _, plr in pairs(Players:GetPlayers()) do
			plr:Kick(`[Vecxo Remote API] Server shutdown initiated by {sender}.`)
		end
		game:Shutdown()
	end

end

Players.PlayerAdded:Connect(function(player)
	if table.find(banned, player.Name) then
		player:Kick("[Vecxo Remote API] You were banned from the game remotely.")
	end
end)

pcall(function()
h=Instance.new('Hint', game.workspace)
h.Text = '[Vecxo Remote API]: Successfully loaded!'
wait(3)
h:Destroy()
end)

while true do
	task.wait(1.5)

	local success, response = pcall(function()
		return HttpService:GetAsync(COMMAND_URL)
	end)

	if success then
		local data = HttpService:JSONDecode(response)
		if data and data.command then
			runCommand(data.command)
		end
	else
		warn("Failed to fetch Discord command:", response)
		end
	end
